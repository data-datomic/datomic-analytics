
/* BitField */
#define	ImageUsesLargePages	0x00000001
#define	IsProtectedProcess	0x00000002
#define	IsImageDynamicallyRelocated	0x00000004
#define	SkipPatchingUser32Forwarders	0x00000008
#define	IsPackagedProcess	0x00000010
#define	IsAppContainer	0x00000020
#define	IsProtectedProcessLight	0x00000040
#define	IsLongPathAwareProcess	0x00000080

/* CrossProcessFlags */
#define	ProcessInJob	0x00000001
#define	ProcessInitializing	0x00000002
#define	ProcessUsingVEH	0x00000004
#define	ProcessUsingVCH	0x00000008
#define	ProcessUsingFTH	0x00000010
#define	ReservedBits0	0xFFFFFFE0

/* TracingFlags */
#define	HeapTracingEnabled	0x00000001
#define	CritSecTracingEnabled	0x00000002
#define	LibLoaderTracingEnabled	0x00000004
#define	SpareTracingBits	0xFFFFFFF8

struct _PEB32 {
	uint8_t	InheritedAddressSpace;
	uint8_t	ReadImageFileExecOptions;
	uint8_t	BeingDebugged;
	uint8_t	BitField;
	uint32_t	Mutant;
	uint32_t	ImageBaseAddress;
	uint32_t	Ldr;
	uint32_t	ProcessParameters;
	uint32_t	SubSystemData;
	uint32_t	ProcessHeap;
	uint32_t	FastPebLock;
	uint32_t	AtlThunkSListPtr;
	uint32_t	IFEOKey;
	uint32_t	CrossProcessFlags;
	union {
		uint32_t	KernelCallbackTable;
		uint32_t	UserSharedInfoPtr;
	};
	uint32_t	SystemReserved[1];
	uint32_t	AtlThunkSListPtr32;
	uint32_t	ApiSetMap;
	uint32_t	TlsExpansionCounter;
	uint32_t	TlsBitmap;
	uint32_t	TlsBitmapBits[2];
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	uint32_t	ReadOnlySharedMemoryBase;
	uint32_t	SparePvoid0;
	uint32_t	ReadOnlyStaticServerData;
	uint32_t	AnsiCodePageData;
	uint32_t	OemCodePageData;
	uint32_t	UnicodeCaseTableData;
	uint32_t	NumberOfProcessors;
	uint32_t	NtGlobalFlag;
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	struct _LARGE_INTEGER	CriticalSectionTimeout;
	uint32_t	HeapSegmentReserve;
	uint32_t	HeapSegmentCommit;
	uint32_t	HeapDeCommitTotalFreeThreshold;
	uint32_t	HeapDeCommitFreeBlockThreshold;
	uint32_t	NumberOfHeaps;
	uint32_t	MaximumNumberOfHeaps;
	uint32_t	ProcessHeaps;
	uint32_t	GdiSharedHandleTable;
	uint32_t	ProcessStarterHelper;
	uint32_t	GdiDCAttributeList;
	uint32_t	LoaderLock;
	uint32_t	OSMajorVersion;
	uint32_t	OSMinorVersion;
	uint16_t	OSBuildNumber;
	uint16_t	OSCSDVersion;
	uint32_t	OSPlatformId;
	uint32_t	ImageSubsystem;
	uint32_t	ImageSubsystemMajorVersion;
	uint32_t	ImageSubsystemMinorVersion;
	uint32_t	ActiveProcessAffinityMask;
	uint32_t	GdiHandleBuffer[34];
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	uint8_t	__padding4__;
	uint8_t	__padding5__;
	uint8_t	__padding6__;
	uint8_t	__padding7__;
	uint8_t	__padding8__;
	uint8_t	__padding9__;
	uint8_t	__padding10__;
	uint8_t	__padding11__;
	uint8_t	__padding12__;
	uint8_t	__padding13__;
	uint8_t	__padding14__;
	uint8_t	__padding15__;
	uint8_t	__padding16__;
	uint8_t	__padding17__;
	uint8_t	__padding18__;
	uint8_t	__padding19__;
	uint8_t	__padding20__;
	uint8_t	__padding21__;
	uint8_t	__padding22__;
	uint8_t	__padding23__;
	uint8_t	__padding24__;
	uint8_t	__padding25__;
	uint8_t	__padding26__;
	uint8_t	__padding27__;
	uint8_t	__padding28__;
	uint8_t	__padding29__;
	uint8_t	__padding30__;
	uint8_t	__padding31__;
	uint8_t	__padding32__;
	uint8_t	__padding33__;
	uint8_t	__padding34__;
	uint8_t	__padding35__;
	uint8_t	__padding36__;
	uint8_t	__padding37__;
	uint8_t	__padding38__;
	uint8_t	__padding39__;
	uint8_t	__padding40__;
	uint8_t	__padding41__;
	uint8_t	__padding42__;
	uint8_t	__padding43__;
	uint8_t	__padding44__;
	uint8_t	__padding45__;
	uint8_t	__padding46__;
	uint8_t	__padding47__;
	uint8_t	__padding48__;
	uint8_t	__padding49__;
	uint8_t	__padding50__;
	uint8_t	__padding51__;
	uint8_t	__padding52__;
	uint8_t	__padding53__;
	uint8_t	__padding54__;
	uint8_t	__padding55__;
	uint8_t	__padding56__;
	uint8_t	__padding57__;
	uint8_t	__padding58__;
	uint8_t	__padding59__;
	uint8_t	__padding60__;
	uint8_t	__padding61__;
	uint8_t	__padding62__;
	uint8_t	__padding63__;
	uint8_t	__padding64__;
	uint8_t	__padding65__;
	uint8_t	__padding66__;
	uint8_t	__padding67__;
	uint8_t	__padding68__;
	uint8_t	__padding69__;
	uint8_t	__padding70__;
	uint8_t	__padding71__;
	uint8_t	__padding72__;
	uint8_t	__padding73__;
	uint8_t	__padding74__;
	uint8_t	__padding75__;
	uint8_t	__padding76__;
	uint8_t	__padding77__;
	uint8_t	__padding78__;
	uint8_t	__padding79__;
	uint8_t	__padding80__;
	uint8_t	__padding81__;
	uint8_t	__padding82__;
	uint8_t	__padding83__;
	uint8_t	__padding84__;
	uint8_t	__padding85__;
	uint8_t	__padding86__;
	uint8_t	__padding87__;
	uint8_t	__padding88__;
	uint8_t	__padding89__;
	uint8_t	__padding90__;
	uint8_t	__padding91__;
	uint8_t	__padding92__;
	uint8_t	__padding93__;
	uint8_t	__padding94__;
	uint8_t	__padding95__;
	uint8_t	__padding96__;
	uint8_t	__padding97__;
	uint8_t	__padding98__;
	uint8_t	__padding99__;
	uint8_t	__padding100__;
	uint8_t	__padding101__;
	uint8_t	__padding102__;
	uint8_t	__padding103__;
	uint8_t	__padding104__;
	uint8_t	__padding105__;
	uint8_t	__padding106__;
	uint8_t	__padding107__;
	uint8_t	__padding108__;
	uint8_t	__padding109__;
	uint8_t	__padding110__;
	uint8_t	__padding111__;
	uint8_t	__padding112__;
	uint8_t	__padding113__;
	uint8_t	__padding114__;
	uint8_t	__padding115__;
	uint8_t	__padding116__;
	uint8_t	__padding117__;
	uint8_t	__padding118__;
	uint8_t	__padding119__;
	uint8_t	__padding120__;
	uint8_t	__padding121__;
	uint8_t	__padding122__;
	uint8_t	__padding123__;
	uint8_t	__padding124__;
	uint8_t	__padding125__;
	uint8_t	__padding126__;
	uint8_t	__padding127__;
	uint8_t	__padding128__;
	uint8_t	__padding129__;
	uint8_t	__padding130__;
	uint8_t	__padding131__;
	uint32_t	PostProcessInitRoutine;
	uint32_t	TlsExpansionBitmap;
	uint32_t	TlsExpansionBitmapBits[32];
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	uint8_t	__padding4__;
	uint8_t	__padding5__;
	uint8_t	__padding6__;
	uint8_t	__padding7__;
	uint8_t	__padding8__;
	uint8_t	__padding9__;
	uint8_t	__padding10__;
	uint8_t	__padding11__;
	uint8_t	__padding12__;
	uint8_t	__padding13__;
	uint8_t	__padding14__;
	uint8_t	__padding15__;
	uint8_t	__padding16__;
	uint8_t	__padding17__;
	uint8_t	__padding18__;
	uint8_t	__padding19__;
	uint8_t	__padding20__;
	uint8_t	__padding21__;
	uint8_t	__padding22__;
	uint8_t	__padding23__;
	uint8_t	__padding24__;
	uint8_t	__padding25__;
	uint8_t	__padding26__;
	uint8_t	__padding27__;
	uint8_t	__padding28__;
	uint8_t	__padding29__;
	uint8_t	__padding30__;
	uint8_t	__padding31__;
	uint8_t	__padding32__;
	uint8_t	__padding33__;
	uint8_t	__padding34__;
	uint8_t	__padding35__;
	uint8_t	__padding36__;
	uint8_t	__padding37__;
	uint8_t	__padding38__;
	uint8_t	__padding39__;
	uint8_t	__padding40__;
	uint8_t	__padding41__;
	uint8_t	__padding42__;
	uint8_t	__padding43__;
	uint8_t	__padding44__;
	uint8_t	__padding45__;
	uint8_t	__padding46__;
	uint8_t	__padding47__;
	uint8_t	__padding48__;
	uint8_t	__padding49__;
	uint8_t	__padding50__;
	uint8_t	__padding51__;
	uint8_t	__padding52__;
	uint8_t	__padding53__;
	uint8_t	__padding54__;
	uint8_t	__padding55__;
	uint8_t	__padding56__;
	uint8_t	__padding57__;
	uint8_t	__padding58__;
	uint8_t	__padding59__;
	uint8_t	__padding60__;
	uint8_t	__padding61__;
	uint8_t	__padding62__;
	uint8_t	__padding63__;
	uint8_t	__padding64__;
	uint8_t	__padding65__;
	uint8_t	__padding66__;
	uint8_t	__padding67__;
	uint8_t	__padding68__;
	uint8_t	__padding69__;
	uint8_t	__padding70__;
	uint8_t	__padding71__;
	uint8_t	__padding72__;
	uint8_t	__padding73__;
	uint8_t	__padding74__;
	uint8_t	__padding75__;
	uint8_t	__padding76__;
	uint8_t	__padding77__;
	uint8_t	__padding78__;
	uint8_t	__padding79__;
	uint8_t	__padding80__;
	uint8_t	__padding81__;
	uint8_t	__padding82__;
	uint8_t	__padding83__;
	uint8_t	__padding84__;
	uint8_t	__padding85__;
	uint8_t	__padding86__;
	uint8_t	__padding87__;
	uint8_t	__padding88__;
	uint8_t	__padding89__;
	uint8_t	__padding90__;
	uint8_t	__padding91__;
	uint8_t	__padding92__;
	uint8_t	__padding93__;
	uint8_t	__padding94__;
	uint8_t	__padding95__;
	uint8_t	__padding96__;
	uint8_t	__padding97__;
	uint8_t	__padding98__;
	uint8_t	__padding99__;
	uint8_t	__padding100__;
	uint8_t	__padding101__;
	uint8_t	__padding102__;
	uint8_t	__padding103__;
	uint8_t	__padding104__;
	uint8_t	__padding105__;
	uint8_t	__padding106__;
	uint8_t	__padding107__;
	uint8_t	__padding108__;
	uint8_t	__padding109__;
	uint8_t	__padding110__;
	uint8_t	__padding111__;
	uint8_t	__padding112__;
	uint8_t	__padding113__;
	uint8_t	__padding114__;
	uint8_t	__padding115__;
	uint8_t	__padding116__;
	uint8_t	__padding117__;
	uint8_t	__padding118__;
	uint8_t	__padding119__;
	uint8_t	__padding120__;
	uint8_t	__padding121__;
	uint8_t	__padding122__;
	uint8_t	__padding123__;
	uint32_t	SessionId;
	struct _ULARGE_INTEGER	AppCompatFlags;
	struct _ULARGE_INTEGER	AppCompatFlagsUser;
	uint32_t	pShimData;
	uint32_t	AppCompatInfo;
	struct _STRING32	CSDVersion;
	uint32_t	ActivationContextData;
	uint32_t	ProcessAssemblyStorageMap;
	uint32_t	SystemDefaultActivationContextData;
	uint32_t	SystemAssemblyStorageMap;
	uint32_t	MinimumStackCommit;
	uint32_t	FlsCallback;
	struct LIST_ENTRY32	FlsListHead;
	uint32_t	FlsBitmap;
	uint32_t	FlsBitmapBits[4];
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	uint8_t	__padding4__;
	uint8_t	__padding5__;
	uint8_t	__padding6__;
	uint8_t	__padding7__;
	uint8_t	__padding8__;
	uint8_t	__padding9__;
	uint8_t	__padding10__;
	uint8_t	__padding11__;
	uint32_t	FlsHighIndex;
	uint32_t	WerRegistrationData;
	uint32_t	WerShipAssertPtr;
	uint32_t	pUnused;
	uint32_t	pImageHeaderHash;
	uint32_t	TracingFlags;
	uint8_t	__padding0__;
	uint8_t	__padding1__;
	uint8_t	__padding2__;
	uint8_t	__padding3__;
	uint64_t	CsrServerReadOnlySharedMemoryBase;
	uint32_t	TppWorkerpListLock;
	struct LIST_ENTRY32	TppWorkerpList;
	uint32_t	WaitOnAddressHashTable[128];
}__attribute__((packed));
