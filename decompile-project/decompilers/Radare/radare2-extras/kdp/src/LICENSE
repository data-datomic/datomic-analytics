Most of this code comes from GNU GDB, so it's GPLv2
